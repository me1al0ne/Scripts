local tpwalking = false  -- Movement initially off
local speed = 50  -- Speed set to 50
local player = game.Players.LocalPlayer
local chr = player.Character or player.CharacterAdded:Wait()
local hum = chr:WaitForChild("Humanoid")

-- Create the GUI
local gui = Instance.new("ScreenGui")
gui.Name = "patrickGui"
gui.Parent = game:GetService("CoreGui")

-- Create the toggle button
local TextButton = Instance.new("TextButton")
TextButton.Text = "Movement OFF"
TextButton.TextSize = 24
TextButton.TextColor3 = Color3.new(1, 1, 1)
TextButton.BackgroundColor3 = Color3.new(0, 0, 0)
TextButton.BorderColor3 = Color3.new(1, 1, 1)
TextButton.BorderSizePixel = 4
TextButton.Font = Enum.Font.Code
TextButton.Size = UDim2.new(0.2, 0, 0.1, 0)
TextButton.Position = UDim2.new(0, 10, 0.5, 0)
TextButton.Draggable = true
TextButton.Parent = gui

local cornerUI = Instance.new("UICorner")
cornerUI.CornerRadius = UDim.new(0, 5)
cornerUI.Parent = TextButton

local uiStroke = Instance.new("UIStroke")
uiStroke.Color = Color3.new(0, 0, 0)
uiStroke.Thickness = 2
uiStroke.Parent = TextButton

-- Toggle logic for movement
TextButton.MouseButton1Click:Connect(function()
    tpwalking = not tpwalking  -- Toggle the movement state
    if tpwalking then
        TextButton.Text = "Movement ON"  -- Update the button text
    else
        TextButton.Text = "Movement OFF"  -- Update the button text
    end
end)

-- Function to move the character with CFrame based on the speed
local function moveCharacter()
    while true do
        wait(0.03)  -- Update interval for movement

        -- Only move if tpwalking is enabled and the character is valid
        if tpwalking and chr and hum and hum.Parent then
            -- Check if the character is moving
            if hum.MoveDirection.Magnitude > 0 then
                -- Get the movement direction and apply speed
                local moveDirection = hum.MoveDirection
                local newCFrame = chr.HumanoidRootPart.CFrame + moveDirection * speed * 0.03  -- Adjust with delta time
                chr.HumanoidRootPart.CFrame = newCFrame
            end
        end
    end
end

-- Start the movement loop
coroutine.wrap(moveCharacter)()  -- Run the movement function in a separate coroutine
